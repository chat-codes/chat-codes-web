<name-entry *ngIf="!hasName" (onEnter)="setName($event)"></name-entry>

<div class="container" *ngIf="hasName && !connected">
    <div class="row">
        <div class="col">Connecting...</div>
    </div>
</div>
<div class="container" *ngIf="hasName && connected">
    <nav class="navbar">
        <span class="navbar-brand">
            <img src="assets/images/cc_icon.svg" class="logo" />
            <input type="text" [value]="getChatURL()" readonly />
        </span>
    </nav>
    <div class="row" id="list_row">
        <div class="col-7">
            <ul class='files nav nav-tabs'>
                <li class='nav-item' *ngFor="let editorState of getActiveEditors()">
                    <a [ngClass]="{'active': editorState.selected}" class='nav-link' href='#' (click)="codeEditor.selectFile(editorState)">
                        {{editorState.getTitle()}}
                        <span class='modifiedFlag' [ngClass]="{'modified':editorState.getIsModified()}"></span>
                    </a>
                </li>
            </ul>
        </div>
        <div class="col-1"></div>
        <div class="col-4">
            Here now:
            <ul class='members'>
                <li class='member' *ngFor="let user of commLayer.userList.activeUsers">
                    <user-display [user]='user'></user-display>
                </li>
            </ul>
        </div>
    </div>
    <div class="row" id="content_row">
        <div class="col-7">
            <code-editor [commLayer]='commLayer' #codeEditor></code-editor>
        </div>
        <div class="col-1">
            <timeline-display></timeline-display>
        </div>
        <div #messageDisplay class="col-4 message-display">
            <div class="no-messages" *ngIf='commLayer.messageGroups.isEmpty()'>
                (no messages)
            </div>
            <ul class='messageGroups'>
                <li class='messageGroup' *ngFor="let messageGroup of commLayer.messageGroups.getMessageGroups()" [ngClass]='"user-"+messageGroup.getSender().colorIndex'>
                    <ul class='messages list-group'>
                        <li class='header list-group-item'>
                            <span class="sender">{{messageGroup.getSender().name}}</span>&nbsp;<span class="time">({{messageGroup.getTimestamp(0) | amTimeAgo}})</span>:
                        </li>
                        <li class='message list-group-item' *ngFor="let message of messageGroup.getMessages()">
                            {{message.message}}
                        </li>
                    </ul>
                </li>
            </ul>
            <div class='typing'>
                <div *ngFor='let user of commLayer.userList.activeUsers'>
                    <div *ngIf='user.typingStatus=="ACTIVE_TYPING" && !user.isMe'>
                        {{user.name}} is typing...
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row" id="input_row">
        <div class="col-7">
            <terminal [commLayer]='commLayer'></terminal>
        </div>
        <div class="col-1"></div>
        <div class="col-4">
            <chat-input (send)='sendTextMessage($event)' (typing)='updateTypingStatus($event)'></chat-input>
        </div>
    </div>
</div>